import Mmenu from"../../core/oncanvas/mmenu.oncanvas";import options from"./_options";import{extendShorthandOptions}from"./_options";import*as DOM from"../../_modules/dom";import*as media from"../../_modules/matchmedia";import{extend}from"../../_modules/helpers";Mmenu.options.sidebar=options;export default function(){var e=this;if(this.opts.offCanvas){var d=extendShorthandOptions(this.opts.sidebar);if(this.opts.sidebar=extend(d,Mmenu.options.sidebar),d.collapsed.use){this.bind("initMenu:after",function(){if(e.node.menu.classList.add("mm-menu_sidebar-collapsed"),d.collapsed.blockMenu&&e.opts.offCanvas&&!DOM.children(e.node.menu,".mm-menu__blocker")[0]){var n=DOM.create("a.mm-menu__blocker");n.setAttribute("href","#"+e.node.menu.id),e.node.menu.prepend(n)}d.collapsed.hideNavbar&&e.node.menu.classList.add("mm-menu_hidenavbar"),d.collapsed.hideDivider&&e.node.menu.classList.add("mm-menu_hidedivider")});var n=function(){e.node.wrpr.classList.add("mm-wrapper_sidebar-collapsed")},a=function(){e.node.wrpr.classList.remove("mm-wrapper_sidebar-collapsed")};"boolean"==typeof d.collapsed.use?this.bind("initMenu:after",n):media.add(d.collapsed.use,n,a)}if(d.expanded.use){this.bind("initMenu:after",function(){e.node.menu.classList.add("mm-menu_sidebar-expanded")});n=function(){e.node.wrpr.classList.add("mm-wrapper_sidebar-expanded"),e.node.wrpr.matches(".mm-wrapper_sidebar-closed")||e.open()},a=function(){e.node.wrpr.classList.remove("mm-wrapper_sidebar-expanded"),e.close()};"boolean"==typeof d.expanded.use?this.bind("initMenu:after",n):media.add(d.expanded.use,n,a),this.bind("close:start",function(){e.node.wrpr.matches(".mm-wrapper_sidebar-expanded")&&(e.node.wrpr.classList.add("mm-wrapper_sidebar-closed"),"remember"==d.expanded.initial&&window.localStorage.setItem("mmenuExpandedState","closed"))}),this.bind("open:start",function(){e.node.wrpr.matches(".mm-wrapper_sidebar-expanded")&&(e.node.wrpr.classList.remove("mm-wrapper_sidebar-closed"),"remember"==d.expanded.initial&&window.localStorage.setItem("mmenuExpandedState","open"))});var i=d.expanded.initial;if("remember"==d.expanded.initial){var s=window.localStorage.getItem("mmenuExpandedState");switch(s){case"open":case"closed":i=s}}"closed"==i&&this.bind("initMenu:after",function(){e.node.wrpr.classList.add("mm-wrapper_sidebar-closed")}),this.clck.push(function(n,a){if(a.inMenu&&a.inListview&&e.node.wrpr.matches(".mm-wrapper_sidebar-expanded"))return{close:"closed"==d.expanded.initial}})}}};